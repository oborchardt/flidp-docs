\RequirePackage{tikz, datetime, graphicx, url}

\usepackage[absolute,overlay]{textpos}
\ifdefined\directlua
  \setbeamerfont{section page}{size=\LARGE,series=\bfseries}
  \setbeamerfont{title}{size=\LARGE,series=\bfseries}
  \setbeamerfont{subtitle}{size=\large,series=\bfseries}
  \setbeamerfont{frametitle}{size=\large,series=\bfseries}
\else
  \setbeamerfont{section page}{size=\LARGE,series=\bfseries}
  \setbeamerfont{title}{size=\LARGE,series=\bfseries}
  \setbeamerfont{subtitle}{size=\large,series=\bfseries}
  \setbeamerfont{frametitle}{size=\large,series=\bfseries}
\fi



\yyyymmdddate \renewcommand{\dateseparator}{.}

\definecolor{uni_grey}{RGB}{201, 201, 201}
\definecolor{uni_granat}{RGB}{176, 47, 45}
\definecolor{uni_karneol}{RGB}{214, 66, 66}
\definecolor{uni_aquamarin}{RGB}{138, 194, 209}
\definecolor{uni_basalt}{RGB}{38, 42, 49}

\definecolor{uni_basalt}{RGB}{38, 42, 49}

\definecolor{dbs_grey}{RGB}{122, 123, 122}
\definecolor{dbs_light_blue}{RGB}{192, 208, 224}
\definecolor{dbs_dark_blue}{RGB}{32, 64, 96}
\definecolor{dbs_hilite}{RGB}{204, 85, 34}

\setbeamercolor*{title page header}{fg=dbs_dark_blue}
\setbeamercolor*{title}{fg=dbs_dark_blue}
\setbeamercolor*{subtitle}{fg=dbs_hilite}
\setbeamercolor*{author}{fg=dbs_dark_blue}
\setbeamercolor*{institute}{fg=dbs_dark_blue}
\setbeamercolor*{date}{fg=dbs_light_blue}
\setbeamercolor*{item}{fg=dbs_dark_blue}
\setbeamercolor*{frametitle}{fg=dbs_dark_blue}
\setbeamercolor*{block title}{fg=black, bg=dbs_light_blue}
\setbeamercolor*{block body}{bg=dbs_light_blue!20}
\setbeamercolor*{section in toc}{fg=black}
\setbeamercolor*{section page}{fg=dbs_dark_blue}
\setbeamercolor*{foot}{fg=black}
\setbeamercolor*{section in head/foot}{fg=uni_basalt}

\setbeamerfont{author}{size=\large,series=\sffamily}
\setbeamerfont{institute}{size=\small, series=\sffamily}

\setbeamertemplate{navigation symbols}{}
\setbeamertemplate{items}[square]
\setbeamertemplate{sections/subsections in toc}[square]


\setbeamerfont{author}{size=\large,series=\sffamily}
\setbeamerfont{institute}{size=\small, series=\sffamily}


\newenvironment{xplainframe}{\bgroup\setbeamertemplate{background}{}\begin{frame}[plain]}{\end{frame}\egroup}


\setbeamertemplate{title page}{
	\begin{textblock*}{8cm}(1.5cm,4.8cm)
    \begin{beamercolorbox}[wd=8cm,left]{title page header}
        \usebeamerfont{title}\usebeamercolor{title}\inserttitle%
    \end{beamercolorbox}
    \end{textblock*}
	\begin{textblock*}{8cm}(1.5cm,5.4cm)
		\begin{beamercolorbox}[wd=8cm,left]{subtitle}
			\usebeamerfont{subtitle}\usebeamercolor{subtitle}%
			\insertsubtitle
		\end{beamercolorbox}
	\end{textblock*}
    \begin{textblock*}{8cm}(1.5cm,6.2cm)
	    \begin{beamercolorbox}[wd=8cm,left]{author}
	      \usebeamerfont{author}\insertauthor%
    	\end{beamercolorbox}
    \end{textblock*}
	\begin{textblock*}{8cm}(1.5cm,6.7cm)
		\begin{beamercolorbox}[wd=8cm,left]{institute}
			\usebeamerfont{institute}\insertinstitute%
		\end{beamercolorbox}
	\end{textblock*}
}

\newcommand{\TitlePageLayout}{
	\setbeamertemplate{background}{
    	\begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
    		\node[yshift=0.7cm,xshift=-3cm] (unile) at (current page.south east)
      		{\includegraphics[width=0.4\textwidth]{Logos/logo.png}};
       		\node[yshift=-1.4cm,xshift=-1.4cm] (bubble) at (current page.north east)
      		{\includegraphics[width=0.2\textwidth]{Logos/dbsbubble.png}};
        	\node[xshift=4cm,yshift=2.5cm] (unilebig) at (current page.west)
          	{\includegraphics[width=0.5\textwidth]{Logos/logo_leipzig.pdf}};
    	\end{tikzpicture}
	}
	\setbeamertemplate{headline}{}
	\setbeamertemplate{footline}{}
}
	
	
\newcommand{\maketitlepage}{{
\TitlePageLayout
\begin{frame}
  \titlepage %
\end{frame}
}}	


\newcommand{\SpecialPageLayout}{
	\setbeamertemplate{background}{
    	\begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
    		\node[yshift=0.6cm,xshift=2cm] (uni) at (current page.south west)
      		{\includegraphics[width=0.1\textwidth]{Logos/logo_leipzig_small.pdf}};
      		\node[yshift=-1.4cm,xshift=-1.4cm] (bubble) at (current page.north east)
      		{\includegraphics[width=0.2\textwidth]{Logos/dbsbubble.png}};
       	 	\begin{scope}[x={(current page.north east)},y={(current page.south west)}]
        		\draw[dbs_grey, thin] (0.075,0.865) -- (0.925,0.865);
       	 	\end{scope}     
    	\end{tikzpicture}
	}
	\setbeamertemplate{headline}{}
}

\AtBeginSection[]
{{
	\SpecialPageLayout
	\ifnum\thepage>2\relax%
	\frame{\sectionpage}
	\fi
}}

\setbeamertemplate{section page}{
	\begin{textblock*}{\paperwidth}(1.5cm,4cm)
		\begin{beamercolorbox}[wd=\paperwidth, left]{section page}
			\insertsectionhead
		\end{beamercolorbox}
	\end{textblock*}
}

\setbeamertemplate{headline}{}


\setbeamertemplate{frametitle}{
	\vspace{0.8cm}
	\begin{beamercolorbox}{frametitle}
			\insertframetitle
	\end{beamercolorbox}
}


\setbeamertemplate{footline}{ 
	\ifnum\thepage>1\relax%
      \begin{textblock*}{10cm}(6cm,8.33cm)
          \begin{beamercolorbox}{section in head/foot}
            \insertauthor \medspace : \medspace \inserttitle
          \end{beamercolorbox}
      \end{textblock*}
        
      \begin{textblock*}{4cm}(14cm,8.33cm)
          \begin{beamercolorbox}{section in head/foot}
            \insertframenumber{}/\inserttotalframenumber
          \end{beamercolorbox}
      \end{textblock*}
	\fi
}

\setbeamertemplate{background}{
	\begin{tikzpicture}[remember picture, overlay,shift=(current page.north west)]
        \node[yshift=0.6cm,xshift=3cm] (uni) at (current page.south west)
      	{\includegraphics[width=0.3\textwidth]{Logos/logo.png}};
      	\node[yshift=-1.4cm,xshift=-1.4cm] (bubble) at (current page.north east)
      		{\includegraphics[width=0.2\textwidth]{Logos/dbsbubble.png}};
        \begin{scope}[x={(current page.north east)},y={(current page.south west)}]      	
        	\draw[dbs_grey, thin] (0.05,0.865) -- (0.925,0.865);
        \end{scope}       	
    \end{tikzpicture}
}

\setbeamertemplate{endpage}{%
	\TitlePageLayout
	\begin{frame}
    \begin{textblock*}{8cm}(1.5cm,4cm)
    \begin{beamercolorbox}[wd=8cm,left]{title page header}
        \usebeamerfont{title}\usebeamercolor{title}Thank you!%
    \end{beamercolorbox}
    \end{textblock*}
    \begin{textblock*}{8cm}(1.5cm,5cm)
	    \begin{beamercolorbox}[wd=8cm,left]{author}
	      \usebeamerfont{author}\insertauthor%
    	\end{beamercolorbox}
    \end{textblock*}
	\begin{textblock*}{8cm}(1.5cm,5.5cm)
		\begin{beamercolorbox}[wd=8cm,left]{institute}
			\usebeamerfont{institute}\insertinstitute%
		\end{beamercolorbox}
	\end{textblock*}
	\begin{textblock*}{8cm}(1.5cm,7cm)
		\begin{beamercolorbox}[wd=8cm,left]{institute}
			\mail%
		\end{beamercolorbox}
	\end{textblock*}
	\end{frame}
}

\AtEndDocument{\usebeamertemplate{endpage}}

